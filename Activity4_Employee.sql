CREATE TABLE EMPEVALUATION
	(EmpNo	        CHAR(3),
     Rating	        VARCHAR(20) NOT NULL,
     RatingPeriod	VARCHAR(20));

CREATE TABLE EMPLOYEE
	(EmpNo		INTEGER NOT NULL,
	 EmpName 	VARCHAR(50) NOT NULL,
     JobLevel	CHAR(3),
     DateHired 	DATE,
     EmpAddress	VARCHAR(20),
CONSTRAINT emp_pk PRIMARY KEY (EmpNo)
);

INSERT INTO EMPLOYEE VALUES
(01, 'Cara Elyssa Dulay', 'ISD', '2015-11-19', 'Manila'),
(02, 'Ian Vincent Bartolome', 'FIN', '2017-06-12', 'Davao'),
(03, 'Agatha Gwen Tagala', 'HR', '2011-01-17', 'Paranaque'),
(04, 'Patrick Sudaria', 'FIN', '2010-04-10', 'Paranaque'),
(05, 'John Dani Oicangi', 'HR', '2010-12-12', 'Manila');

UPDATE EMPEVALUATION
SET Rating = 70
WHERE EmpNo = 03 AND RatingPeriod = 'FY2017';

SET SQL_SAFE_UPDATES = 0;

UPDATE EMPLOYEE
SET DateHired = '2020-11-22'
WHERE EmpNo = 03 ;

SELECT *
FROM EMPLOYEE;

INSERT INTO EMPEVALUATION VALUES
(01, 90, 'FY2020'), (01, 75, 'FY2019'), (01, 74, 'FY2018'), (01, 70, 'FY2017'),
(02, 100, 'FY2020'), (02, 100, 'FY2019'), (02, 90, 'FY2018'), (02, 95, 'FY2017'),
(03, 70, 'FY2020'), (03, 88, 'FY2019'), (03, 73, 'FY2018'), (03, 70, 'FY2017'),
(04, 100, 'FY2020'), (04, 90, 'FY2019'), (04, 97, 'FY2018'), (04, 85, 'FY2017'),
(05, 95, 'FY2020'), (05, 90, 'FY2019'), (05, 100, 'FY2018'), (05, 75, 'FY2017');

SELECT EMPEVALUATION.EmpNo, EMPEVALUATION.Rating, EMPEVALUATION.Rating Period
FROM EMPEVALUATION
LEFT OUTER JOIN EMPLOYEE
ON EMPEVALUATION.EmpNo = EMPLOYEE.EmpNo;

SELECT *
FROM EMPLOYEE;

SELECT DISTINCT EMPEVALUATION.EmpNo, EMPLOYEE.EmpName, EMPLOYEE.EmpAddress
FROM EMPEVALUATION
INNER JOIN EMPLOYEE
ON EMPEVALUATION.EmpNo = EMPLOYEE.EmpNo AND Rating >= 90;

SELECT EMPLOYEE.EmpNo
FROM EMPLOYEE
WHERE EMPLOYEE.DateHired >= CAST('2018-12-31' as DATE)
INTERSECT
SELECT EmpNo
FROM EMPEVALUATION
WHERE EMPEVALUATION.Rating > 90 AND EMPEVALUATION.RatingPeriod = 'FY2019'; 

SELECT EMPEVALUATION.EmpNo
FROM EMPEVALUATION
INNER JOIN EMPLOYEE
ON EMPEVALUATION.EmpNo = EMPLOYEE.EmpNo 
AND EMPEVALUATION.Rating >=90 AND EMPLOYEE.DateHired >= '2018-12-31' AND EMPEVALUATION.RatingPeriod = 'FY2019'; 

SELECT EmpNo
FROM EMPLOYEE
WHERE EMPLOYEE.DateHired >= '2018-12-31'
HAVING EmpNo IN(SELECT EmpNo FROM EMPEVALUATION WHERE EMPEVALUATION.Rating >=90 AND EMPEVALUATION.RatingPeriod = 'FY2019');

SELECT EMPEVALUATION.EmpNo, EMPLOYEE.EmpName, EMPLOYEE.EmpAddress
FROM EMPLOYEE
RIGHT OUTER JOIN EMPEVALUATION
ON EMPEVALUATION.EmpNo = EMPLOYEE.EmpNo
WHERE EMPEVALUATION.Rating > 70 AND EMPEVALUATION.Rating < 75 AND EMPEVALUATION.RatingPeriod = 'FY2018';

SELECT EMPEVALUATION.EmpNo
FROM EMPEVALUATION
WHERE EMPEVALUATION.Rating < 90
NOT IN (SELECT EMPEVALUATION.EmpNo
FROM EMPEVALUATION
WHERE EMPEVALUATION.Rating >= 90);
